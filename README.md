## ‚úÖ README.md ‚Äî ChallengeForge Bot

* **ChallengeForge Bot** ‚Äî Telegram-–±–æ—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —á–µ–ª–ª–µ–Ω–¥–∂–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.
* –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ **aiogram v3**, SQLite, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —á–µ–ª–ª–µ–Ω–¥–∂–µ–π** —á–µ—Ä–µ–∑ `/challenge`
* **–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ** üëç/üëé –∑–∞ —á–µ–ª–ª–µ–Ω–¥–∂–∏ (–≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥)
* **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** —á–µ–ª–ª–µ–Ω–¥–∂–µ–π + –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–∏—Ç—å **–∑–∞–º–µ—Ç–∫—É**
* **–ò–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º** ‚Äî –º–æ–∂–Ω–æ –¥–µ–ª–∏—Ç—å—Å—è —á–µ–ª–ª–µ–Ω–¥–∂–∞–º–∏ –≤ –¥—Ä—É–≥–∏–µ —á–∞—Ç—ã
* **–ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤** `/my` –∏ `/top`
* **Rate-limit** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
* **FSM** (finite state machine) –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ ¬´–¥–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É?¬ª
* –ß–∏—Å—Ç—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ `callback_data`, —Å HMAC-–ø–æ–¥–ø–∏—Å–∞–º–∏
* –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
challengeforge-bot/
‚îÇ
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # –≤—Ö–æ–¥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                 # —Å–æ–∑–¥–∞–Ω–∏–µ Bot/Dispatcher
|   ‚îú‚îÄ‚îÄ logger_config.py       # –ª–æ–≥–≥–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ config.py              # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py            # /start /help
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ challenge.py       # –≤—Å—è –ª–æ–≥–∏–∫–∞ —á–µ–ª–ª–µ–Ω–¥–∂–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inline.py          # inline-query –æ—Ç–≤–µ—Ç—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ challenge.py       # –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pagination.py      # –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ callbacks.py       # encode/decode callback_data
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ states/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_state.py      # FSM: –æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py              # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ SQLite
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_repo.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ challenge_repo.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vote_repo.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ saved_repo.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ challenge_factory.py  # –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —á–µ–ª–ª–µ–Ω–¥–∂–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rendering.py          # —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ teleutil.py           # –±–µ–∑–æ–ø–∞—Å–Ω—ã–π edit_message
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ middlewares/
‚îÇ       ‚îú‚îÄ‚îÄ ratelimit.py      # –∞–Ω—Ç–∏—Å–ø–∞–º
‚îÇ
‚îú‚îÄ‚îÄ .env                      # —Å–µ–∫—Ä–µ—Ç—ã (BOT_TOKEN –∏ –¥—Ä.)
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ database.db               # –∞–≤—Ç–æ–º–∞—Ç–æ–º —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
```

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
git clone https://github.com/LerkOFF/challengeforge-bot.git
cd challengeforge-bot
```

### 2) –°–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
python -m venv .venv
.venv\Scripts\activate
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` —Ä—è–¥–æ–º —Å `main.py`:

```
BOT_TOKEN=—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–æ—Ç_BotFather
DB_PATH=database.db
CALLBACK_SECRET=–ª—é–±–æ–π_—Å–ª—É—á–∞–π–Ω—ã–π_—Å–µ–∫—Ä–µ—Ç_–¥–ª—è_HMAC
```

> **CALLBACK_SECRET** ‚Äî –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ —Å–∏–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

```bash
python app/main.py
```

---

## üí¨ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞      | –û–ø–∏—Å–∞–Ω–∏–µ                                         |
| ------------ |--------------------------------------------------|
| `/start`     | —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                         |
| `/help`      | —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥                                    |
| `/challenge` | –≤—ã–¥–∞—ë—Ç —Å–ª—É—á–∞–π–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂                        |
| `/my`        | –≤–∞—à–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏ (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)        |
| `/top`       | –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–ø —á–µ–ª–ª–µ–Ω–¥–∂–µ–π                        |
| `/cancel`    | –æ—Ç–º–µ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–º–µ–Ω–∞ –≤–≤–æ–¥–∞ –∑–∞–º–µ—Ç–∫–∏) |
| `/notes`     | –∑–∞–º–µ—Ç–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —á–µ–ª–ª–µ–Ω–¥–∂–µ–π                   |

---

## üß© –ò–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç inline:

* –í–≤–µ–¥–∏—Ç–µ –≤ –ª—é–±–æ–º —á–∞—Ç–µ:

  ```
  @username_bot cid:123
  ```
* –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è** –ø–æ–¥ –∫–∞—Ä—Ç–æ—á–∫–æ–π

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ ‚Äî –±–æ—Ç –æ—Ç–¥–∞—Å—Ç –∫–∞—Ä—Ç–æ—á–∫—É —á–µ–ª–ª–µ–Ω–¥–∂–∞ —Å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º.

–ì–æ–ª–æ—Å–∞ **–≥–ª–æ–±–∞–ª—å–Ω—ã** ‚Äî —Ä–µ–π—Ç–∏–Ω–≥ –æ–±—â–∏–π.

---

## üîç –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ

* –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å—Ç–∞–≤–∏—Ç—å üëç –∏–ª–∏ üëé
* –ï—Å–ª–∏ –∂–º—ë—Ç —Ç—É –∂–µ –∫–Ω–æ–ø–∫—É –ø–æ–≤—Ç–æ—Ä–Ω–æ ‚Äî –≥–æ–ª–æ—Å —Å–Ω–∏–º–∞–µ—Ç—Å—è
* –†–µ–π—Ç–∏–Ω–≥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π `edit_message` –¥–∞–∂–µ –≤ inline-—Å–æ–æ–±—â–µ–Ω–∏—è—Ö

---

## üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

SQLite –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã:

* `users` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
* `challenges` ‚Äî —á–µ–ª–ª–µ–Ω–¥–∂–∏
* `votes` ‚Äî –≥–æ–ª–æ—Å–∞
* `saved` ‚Äî —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏ + –∑–∞–º–µ—Ç–∫–∏

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –ú–∏–Ω–∏-–ø—Ä–æ—Ç–æ–∫–æ–ª `callback_data`:

  ```
  cf:1:<type>:<...>[:sig]
  ```
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–µ—Ä—Å–∏–∏ (`1`)
* HMAC-–ø–æ–¥–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö (`sig`)
* –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Ä–µ–≥—É–ª—è—Ä–∫–∞–º–∏
* Rate-limit –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏ callback-–æ–≤

---

## ‚õìÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* Python 3.13
* aiogram v3.7+
* aiosqlite
* FSMContext (aiogram)
* SQLite
* HMAC –ø–æ–¥–ø–∏—Å–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

* –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
* –¢–µ—Å—Ç –∫–æ–¥–µ–∫–∞ `callback_data`
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç:
  `/challenge ‚Üí üëç ‚Üí üíæ ‚Üí –î–∞ ‚Üí —Ç–µ–∫—Å—Ç`.

---

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã
‚úÖ –ò–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º
‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è
‚úÖ FSM –∑–∞–º–µ—Ç–æ–∫
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–ª–ª–±–µ–∫–∏

---
